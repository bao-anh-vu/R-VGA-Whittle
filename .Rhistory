# lines(density(phi_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss"),
col = c("red", "blue"), lty = 1, lwd = 2)
plot(density(gaussian_mcmc_post_samples), xlab = "phi", xlim = c(0.85, 1),
col = "blue", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(draws), col = "red", lwd = 2)
# lines(density(phi_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss"),
col = c("red", "blue"), lty = 1, lwd = 2)
draws[draws >= 1]
source("~/R-VGA-whittle/rvga_whittle.R")
source("~/R-VGA-whittle/rvga_whittle.R")
source("~/R-VGA-whittle/rvga_whittle.R")
plot(spectral_dens - spectral_dens2)
plot(spectral_dens, type = "l")
lines(spectral_dens2, col = "red")
source("~/R-VGA-whittle/rvga_whittle.R")
plot(density(gaussian_mcmc_post_samples), xlab = "phi", #xlim = c(0.85, 1),
col = "blue", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(draws), col = "red", lwd = 2)
# lines(density(phi_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss"),
col = c("red", "blue"), lty = 1, lwd = 2)
source("~/R-VGA-whittle/rvga_whittle.R")
source("~/R-VGA-whittle/rvga_whittle.R")
source("~/R-VGA-whittle/rvga_whittle.R")
source("~/R-VGA-whittle/rvga_whittle.R")
save_plots <- T
if (save_plots) {
png(paste0("rvga_whittle_results_n", n, ".png"), width = 600, height = 450)
plot(density(gaussian_mcmc_post_samples), xlab = "phi", #xlim = c(0.88, 0.92),
col = "blue", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(draws), col = "red", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss"),
col = c("red", "blue"), lty = 1, lwd = 2)
dev.off()
}
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
freq_in_likelihood[i]
phi_s
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
I[[i]]
length(I)
length(freq_in_likelihood)
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
grad2_logW
source("~/R-VGA-whittle/rvga-whittle.R")
prec_temp <- prec_temp - a * E_grad2_logW
prec_temp
mu_temp
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
warnings()
source("~/R-VGA-whittle/rvga-whittle.R")
mu_temp
P
prec[[1]]
prec[[2]]
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
prec_temp
(2 * (1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i])) -
2 * (phi_s + cos(2*pi*freq_in_likelihood[i])))^2 /
(1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i]))^2 +
2 * I[[i]] / sigma_e^2
grad2_logW
a
E_grad2_logW
phi_s
(2 * (1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i]))
)
((2 * (1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i])) -
2 * (phi_s + cos(2*pi*freq_in_likelihood[i])))^2) /
(1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i]))^2 +
2 * I[[i]] / sigma_e^2
(1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i]))^2
((2 * (1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i])) -
2 * (phi_s + cos(2*pi*freq_in_likelihood[i])))^2)
print(((2 * (1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i])) -
2 * (phi_s + cos(2*pi*freq_in_likelihood[i])))^2) /
(1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i]))^2)
2 * I[[i]] / sigma_e^2
I[[i]]
source("~/R-VGA-whittle/rvga-whittle.R")
prec_temp
mu_temp
E_grad2_logW
grad2_logW
phi_s
samples
tanh(samples[s])
tanh(samples)
hist(samples)
density(samples)
hist(tanh(samples))
source("~/R-VGA-whittle/rvga-whittle.R")
grad_phi_fd
grad_logW
grad_phi_2_fd
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
# ## Plot posterior
post_var <- solve(prec[[length(freq_in_likelihood)]])
rvga.post_samples <- rmvnorm(10000, mu_vals[[length(freq_in_likelihood)]], post_var) # these are samples of beta, log(sigma_a^2), log(sigma_e^2)
rvga.post_samples <- rnorm(10000, mu_vals[[length(freq_in_likelihood)]], post_var) # these are samples of beta, log(sigma_a^2), log(sigma_e^2)
plot(density(rvga.post_samples))
mu_vals[[length(freq_in_likelihood)]]
plot(unlist(mu_vals))
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
E_grad
E_hessian
mu_vals
source("~/R-VGA-whittle/rvga-whittle.R")
tail(unlist(mu_vals))
## Initial theta:
theta_0 <- 1
theta_curr <- theta_0
phi_curr <- tanh(theta_curr)
phi_curr
tanh(0)
source("~/R-VGA-whittle/rvga-whittle.R")
mu_vals
rvga.post_samples <- rnorm(10000, mu_vals[[length(freq_in_likelihood)]], sqrt(post_var)) # these are samples of beta, log(sigma_a^2), log(sigma_e^2)
source("~/R-VGA-whittle/rvga-whittle.R")
plot(density(rvga.post_samples))
plot(density(tanh(rvga.post_samples)))
head(rvga.post_samples)
head(tanh(rvga.post_samples))
tanh(0.0001)
tanh(0.1)
grads
hessian
grad2_logW
grad_logW
grad_phi_fd
grad_phi_2_fd
f_phi_s
f_phi_add
grad_phi_fd
plot(unlist(grads))
hea(mu_Vals)
hea(mu_vals)
head(mu_vals)
source("~/R-VGA-whittle/mcmc_whittle.R")
1/prec_temp
(a * E_grad)
1/prec_temp %*% (a * E_grad)
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
1/prec_temp
1/prec_temp %*% (a * E_grad)
a * E_grad
1/prec_temp * (a * E_grad)
source("~/R-VGA-whittle/rvga-whittle.R")
lines(density(tanh(rvga.post_samples)), col = "goldenrod")
plot(density(tanh(rvga.post_samples)), col = "goldenrod")
plot(unlist(mu_vals), col = "red")
plot(unlist(mu_vals), type = "l")
n
source("~/R-VGA-whittle/mcmc_whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
plot(density(draws), xlab = "phi", #xlim = c(0.85, 1),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
# lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
# lines(density(phi_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss"),
col = c("red", "blue"), lty = 1, lwd = 2)
# lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
# lines(density(phi_samples), col = "goldenrod", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
plot(density(rvga.post_samples), col = "goldenrod", lwd = 2)
source("~/R-VGA-whittle/rvga-whittle.R")
plot(density(rvga.post_samples), col = "goldenrod", lwd = 2)
grads
hessian
plot(unlist(mu_vals), type = "l"
)
source("~/R-VGA-whittle/rvga-whittle.R")
prec[[1]]
prec[[2]]
prec[[3]]
prec[[499]]
post_var
source("~/R-VGA-whittle/rvga-whittle.R")
grad_phi_fd
grad_logW
grad2_logW
grad_phi_2_fd
source("~/R-VGA-whittle/rvga-whittle.R")
prec_temp
prec_temp
a * E_hessian
E_hessian
hessian
source("~/R-VGA-whittle/rvga-whittle.R")
prec_temp
mu_temp
# First derivative
grad_logW <- -2 * (phi_s + cos(2*pi*freq_in_likelihood[i])) *
1 / (1 + phi_s^2 - 2 * phi_s * cos(2*pi*freq_in_likelihood[i])) + I[[i]] / sigma_e^2
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
grad_phi_fd
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
grad_phi_fd
grad2_logW
grad_phi_2_fd
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
grad2_logW
grad_logW
source("~/R-VGA-whittle/rvga-whittle.R")
grad2_logW
grad_logW
grad_phi_fd
grad_phi_2_fd
head(I)
})
head(I)
plot(I)
phi_s
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
E_grad
E_hessian
prec_temp
mu_temp
# First derivative
grad_logW <- (2 * phi_s - 2 * cos(freq_in_likelihood[i])) *
(1 / (1 + phi_s^2 - 2 * phi_s * cos(freq_in_likelihood[i])) - I[[i]] / sigma_e^2)
grad_logW
grad2_logW <- (2 * (1 + phi_s^2 - 2 * phi_s * cos(freq_in_likelihood[i])) -
(2 * phi_s - 2 * cos(freq_in_likelihood[i]))^2) /
(1 + phi_s^2 - 2 * phi_s * cos(freq_in_likelihood[i]))^2 -
2 * I[[i]]/sigma_e^2
grad2_logW
source("~/R-VGA-whittle/rvga-whittle.R")
grad_logW
grad2_logW
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
plot(density(draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
lines(density(rvga.post_samples, col = "goldenrod", lwd = 2))
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
plot(density(draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
# lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
lines(density(rvga.post_samples, col = "goldenrod", lwd = 2))
# lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
plot(density(draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
# lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
save_plots
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
## Compare with exact likelihood
gaussian_mcmc_results <- readRDS(file = paste0(result_directory, "mcmc_gaussian_results_n", n, "_", date, ".rds"))
gaussian_mcmc_post_samples <- gaussian_mcmc_results$post_samples[-(1:burn_in)]
plot(density(draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
source("~/R-VGA-whittle/rvga-whittle.R")
if (save_plots) {
png(paste0("rvga_mcmc_whittle_results_n", n, ".png"), width = 600, height = 450)
plot(density(gaussian_mcmc_post_samples), xlab = "phi", #xlim = c(0.88, 0.92),
col = "blue", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(draws), col = "red", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topleft", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
dev.off()
}
plot(density(draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(gaussian_mcmc_post_samples), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
source("~/R-VGA-whittle/rvga-whittle.R")
warnings()
source("~/R-VGA-whittle/rvga-whittle.R")
prec_temp
mu_temp
E_grad
E_hessian
source("~/R-VGA-whittle/rvga-whittle.R")
source("run_mcmc_ar1.R")
##############################################
##        MCMC with Whittle likelihood      ##
##############################################
print("Starting MCMC with Whittle likelihood...")
if (rerun_mcmc_whittle) {
mcmc_whittle_filepath <- paste0(result_directory, "mcmc_whittle_results_n", n, "_", date, ".rds")
mcmc.post_samples <- run_mcmc_ar1(data = x, sigma_e =  sigma_e,
iters = 15000, burn_in = 5000,
prior_mean = 0, prior_var = 1,
adapt_proposal = T, use_whittle_likelihood = T)
}
rerun_mcmc_whittle <- T
rerun_mcmc_exact <- T
if (rerun_mcmc_whittle) {
mcmc_whittle_filepath <- paste0(result_directory, "mcmc_whittle_results_n", n, "_", date, ".rds")
mcmcw.post_samples <- run_mcmc_ar1(data = x, sigma_e =  sigma_e,
iters = 15000, burn_in = 5000,
prior_mean = 0, prior_var = 1,
adapt_proposal = T, use_whittle_likelihood = T)
}
if (rerun_mcmc_exact) {
mcmc_exact_filepath <- paste0(result_directory, "mcmc_exact_results_n", n, "_", date, ".rds")
mcmce.post_samples <- run_mcmc_ar1(data = x, sigma_e =  sigma_e,
iters = 15000, burn_in = 5000,
prior_mean = 0, prior_var = 1,
adapt_proposal = T, use_whittle_likelihood = F)
}
mcmcw.post_samples <- as.mcmc(mcmcw.post_samples)
mcmcw.post_samples <- as.mcmc(mcmcw.post_samples)
mcmce.post_samples <- as.mcmc(mcmce.post_samples)
plot(density(mcmcw.post_samples), col ="red")
head(mcmcw.post_samples)
mcmce.post_samples <- as.mcmc(mcmce_results$post_samples)
source("~/R-VGA-whittle/rvga-whittle.R")
if (rerun_mcmc_whittle) {
mcmcw_results <- run_mcmc_ar1(data = x, sigma_e =  sigma_e,
iters = MCMC_iters, burn_in = burn_in,
prior_mean = 0, prior_var = 1,
adapt_proposal = T, use_whittle_likelihood = T)
if (save_mcmcw_results) {
saveRDS(mcmcw_results, mcmcw_filepath)
}
} else {
mcmcw_results <- readRDS(mcmc_whittle_filepath)
}
source("~/R-VGA-whittle/rvga-whittle.R")
# Convert draws into "mcmc" object that CODA likes
# draws <- as.mcmc(tanh(post_samples))
mcmcw.draws <- as.mcmc(mcmcw.post_samples)
# Convert draws into "mcmc" object that CODA likes
# draws <- as.mcmc(tanh(post_samples))
mcmcw.draws <- as.mcmc(mcmcw.post_samples)
mcmce.draws <- as.mcmc(mcmce.post_samples)
# Cumulative posterior quantiles
cumuplot(mcmcw.draws, probs = c(0.025, 0.5, 0.975), ylab = "", lty = c(2, 1),
lwd = c(1, 2), type = "l", ask, auto.layout = TRUE, col = 1)
#######################################################
# ASSESSING MCMC CONVERGENCE
#######################################################
# Cumulative quantiles plot
ask <- FALSE
par(mfrow = c(1,1))
# Cumulative posterior quantiles
cumuplot(mcmcw.draws, probs = c(0.025, 0.5, 0.975), ylab = "", lty = c(2, 1),
lwd = c(1, 2), type = "l", ask, auto.layout = TRUE, col = 1)
# Trace plot
traceplot(draws, main = "Trace plot")
# Trace plot
traceplot(mcmcw.draws, main = "Trace plot")
plot(density(mcmcw.draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
rvga_results <- readRDS(rvga_filepath)
rvga.post_samples <- rvga_results$post_samples
plot(density(mcmcw.draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC Gauss", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
save_plots
save_plots <- T
if (save_plots) {
png(paste0("rvga_mcmc_whittle_results_n", n, ".png"), width = 600, height = 450)
plot(density(mcmcw.draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC exact", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
dev.off()
}
source("~/R-VGA-whittle/rvga-whittle.R")
#######################################################
# INSPECT EFFICIENCY
#######################################################
# Get autocorrelation from CODA
autocorr(mcmcw.draws, lags = c(0, 1, 5, 10, 50), relative=TRUE)
lag.max <- 20
# Effective sample size and inefficiency factors
# Compute effective sample size (ESS). This is of course done after burn-in
ESS <- effectiveSize(mcmcw.draws)
cat("ESS =", ESS)
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
rvga.post_samples <- tanh(rvga_results$post_samples)
plot(density(mcmcw.draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC exact", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
head(rvga.post_samples)
rerun_rvga
source("~/R-VGA-whittle/rvga-whittle.R")
temper_schedule
mcmcw_results <- readRDS(mcmcw_filepath)
source("~/R-VGA-whittle/rvga-whittle.R")
if (rerun_mcmce_exact) {
mcmce_results <- run_mcmc_ar1(data = x, sigma_e =  sigma_e,
iters = MCMC_iters, burn_in = burn_in,
prior_mean = 0, prior_var = 1,
adapt_proposal = T, use_whittle_likelihood = F)
if (save_mcmce_results) {
saveRDS(mcmce_results, mcmce_filepath)
}
}
mcmce_results <- readRDS(mcmce_filepath)
source("~/R-VGA-whittle/rvga-whittle.R")
plot(unlist(rvga_results$mu), type = "l")
tanh(1)
rvga_results$mu[5000]
tanh(rvga_results$mu[5000])
tanh(1.096455)
rvga.post_samples <- rvga_results$post_samples)
rvga.post_samples <- rvga_results$post_samples
plot(density(mcmcw.draws), xlab = "phi", #xlim = c(0.88, 0.92),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
head(rvga.post_samples)
plot(density(rvga.post_samples))
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
plot(density(rvga.post_samples))
source("~/R-VGA-whittle/rvga-whittle.R")
warnings()
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
plot(density(rvga.post_samples))
S
a
use_tempering
plot(unlist(rvga_results$mu), type = "l")
rvga_results$mu[[5000]]
length(freq_in_likelihood)
tanh(0.74)
margin <- 0.2
plot(density(mcmcw.draws), xlab = "phi", xlim = c(phi - margin, phi + margin),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC exact", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
margin <- 0.1
plot(density(mcmcw.draws), xlab = "phi", xlim = c(phi - margin, phi + margin),
col = "red", main = paste0("Posterior draws (series length = ", n, ")"), lwd = 2)
lines(density(mcmce.draws), col = "blue", lwd = 2)
lines(density(rvga.post_samples), col = "goldenrod", lwd = 2)
abline(v = phi, col = "black", lty = 2, lwd = 2)
legend("topright", legend = c("MCMC Whittle", "MCMC exact", "R-VGA"),
col = c("red", "blue", "goldenrod"), lty = 1, lwd = 2)
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
source("~/R-VGA-whittle/rvga-whittle.R")
